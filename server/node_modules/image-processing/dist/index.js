"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var packer_1 = require("./texture-atlas-packer/packer");
var ImageMagickImageProcessor_1 = require("./gm-image-processor/ImageMagickImageProcessor");
var path = require("path");
var PIXIManifestSaver_1 = require("./PIXIManifestSaver");
function metapacker(atlases, generateOptions, log, options) {
    log = log ? log : console;
    log.log('START');
    var impath = path.resolve(__dirname, '../imagemagick/');
    // log.log('path.resolve(__dirname, \'../imagemagick/\')', impath);
    // log.log('__filename', __filename);
    // log.log('__dirname', __dirname);
    var imageProcessor = null;
    if (options.imageProcessor === 'ImageMagickImageProcessor') {
        var opt = Object.assign({
            imageMagick: true,
            appPath: (process.platform === 'darwin') ? '/usr/local/bin/' : impath + '/'
        }, options.imageProcessorOptions);
        imageProcessor = new ImageMagickImageProcessor_1.default(opt);
    }
    var saver = null;
    if (options.saver === 'PIXIManifestSaver') {
        saver = PIXIManifestSaver_1.default;
    }
    return packer_1.packer(atlases, generateOptions, imageProcessor, saver, log)
        .then(function (output) {
        log.log('OK');
        return output;
    })
        .catch(function (error) {
        log.error('Error', error);
        throw error;
    });
}
exports.metapacker = metapacker;
var ImageStats_1 = require("./ImageStats");
exports.getImageStatsProcessor = ImageStats_1.getImageStatsProcessor;
//# sourceMappingURL=index.js.map